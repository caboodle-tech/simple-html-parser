/**
 * simple-html-parser v2.4.0 Copyright (c) 2026 Caboodle Tech
 * License and source: https://github.com/caboodle-tech/simple-html-parser
 */
const t=/:not\(([^)]+)\)/g,e=/\[([^\]]+)\]/g,n=/\.([a-zA-Z0-9\-_]+)/g,s=/#([a-zA-Z0-9\-_]+)/,i=/([a-zA-Z0-9\-_]+)?(\#[a-zA-Z0-9\-_]+)?(\.[a-zA-Z0-9\-_]+)*(\[[^\]]+\])*/g,r=/^[a-zA-Z0-9\-_]+/,o=/^["'](.*)["']$/,c=/\s+/,l=["img","br","hr","input","meta","link","area","base","col","embed","param","source","track","wbr"];class h{attributes={};children=[];content="";name="";parent=null;type="";constructor(t,e="",n={},s=null){this.type=t,this.name=e,this.attributes=n,this.parent=s}[Symbol.iterator](){let t="root"===this.type&&this.children.length>0?this.children[0]:this,e=!1,n=!1,s=!1;const i=t=>{if(!t||"root"===t.type&&null===t.parent)return null;if(t.parent){const e=t.parent.children,n=e.indexOf(t);if(n<e.length-1)return e[n+1]}return i(t.parent)},r=h.prototype.remove;return h.prototype.remove=function(){return this===t&&(s=!0),r.call(this)},{next(){if(!t)return h.prototype.remove=r,{value:void 0,done:!0};if(!e)return e=!0,t.skipChildren=function(){n=!0},{value:t,done:!1};s=!1,n=!1;const o=(t=>{if(s)return t.parent?i(t.parent):null;if(!n&&t.children.length>0)return t.children[0];if("root"===t.type&&null===t.parent)return null;if(t.parent){const e=t.parent.children,n=e.indexOf(t);if(-1===n)return i(t.parent);if(n<e.length-1)return e[n+1]}return i(t.parent)})(t),c=t;return t=o,t?t.skipChildren=function(){n=!0}:h.prototype.remove=r,{value:c,done:!1}}}}appendChild(...t){const e=t.flat();for(const t of e)t.parent=this,this.children.push(t);return e}#t(t,e,n,s){const{includeBraces:i,includeSelector:r,includeNestedRules:o,flattenNested:c,singleLine:l,indent:h}=s,a=l?"":" ".repeat(h),p=l?" ":"\n";let u="";r&&t&&(u+=`${a}${t}`),i&&(u+=r&&t?` {${p}`:`{${p}`);const f=i&&!l?h+4:h,d=l?"":" ".repeat(f),g=Object.entries(e);for(let t=0;t<g.length;t++){const[e,s]=g[t];l?(u+=`${e}: ${s};`,(t<g.length-1||n.length>0)&&(u+=" ")):u+=`${d}${e}: ${s};${p}`}if(o&&n.length>0)for(const e of n)if("css-rule"===e.type){const n=e.cssDeclarations||{},i=e.children?.filter(t=>"css-rule"===t.type||"css-at-rule"===t.type)||[];if(c){const r=`${t} ${e.cssSelector}`;l||(u+="\n"),u+=this.#t(r,n,i,{...s,indent:h})}else u+=this.#t(e.cssSelector,n,i,{...s,indent:f});l||(u+="\n")}return i&&(u+=l?" }":`${a}}`),u}createNode(t,e={},n=null){const s=new h("tag-open",t,e);if(null!==n)if("string"==typeof n){const t=new h("text");t.content=n,s.children.push(t),t.parent=s}else if(Array.isArray(n)){const t=n.flat();for(const e of t)s.children.push(e),e.parent=s}else n instanceof h&&(s.children.push(n),n.parent=s);if(!l.includes(t.toLowerCase())){return[s,new h("tag-close",t)]}return[s]}cssFindAtRules(t=null){const e=[],n=s=>{if("css-at-rule"===s.type&&(null!==t&&s.cssName!==t||e.push(s)),s.children)for(const t of s.children)n(t)};return n(this),e}cssFindRules(t,e={}){const{includeCompound:n=!0,shallow:s=!1}=e,i=[],r=e=>{if("css-rule"===e.type){let r=!1;if(n){if(!t.startsWith(".")&&!t.startsWith("#")&&!t.startsWith("[")){r=new RegExp(`\\b${t}\\b`,"i").test(e.cssSelector)}else r=e.cssSelector.includes(t)}else{r=e.cssSelector.split(",").flatMap(t=>t.trim().split(c)).map(t=>t.trim()).includes(t)}if(r)if(s){const t=Object.create(Object.getPrototypeOf(e));Object.assign(t,e),t.children=e.children.filter(t=>"css-rule"!==t.type&&"css-at-rule"!==t.type),i.push(t)}else i.push(e)}if(e.children)for(const t of e.children)r(t)};return r(this),i}cssFindVariable(t,e=null){const n=t.startsWith("--")?t:`--${t}`;if(e)return e.cssDeclarations?.[n]||null;const s=t=>{if(t.cssDeclarations&&t.cssDeclarations[n])return t.cssDeclarations[n];if(t.children)for(const e of t.children){const t=s(e);if(t)return t}return null};return s(this)}cssFindVariables(t={}){const{includeRoot:e=!1}=t,n=[],s=(t,i="")=>{let r=i;if("css-rule"===t.type)r=i?`${i} > ${t.cssSelector}`:t.cssSelector;else if("css-at-rule"===t.type){const e=`@${t.cssName}${t.cssParams?` ${t.cssParams}`:""}`;r=i?`${i} > ${e}`:e}if(t.cssDeclarations)for(const[s,i]of Object.entries(t.cssDeclarations))if(s.startsWith("--")){let o=r;!e&&t.parent&&"css-root"===t.parent.type&&(o=":root"===t.cssSelector?":root":t.cssSelector),n.push({name:s,value:i,scope:o,rule:t})}if(t.children)for(const e of t.children)s(e,r)};return s(this),n}cssToString(t,e={}){let n,s;if(void 0===t||"object"==typeof t&&!Array.isArray(t)&&!t.type){s=t||{};const e=this.querySelectorAll("style");n=e.length>0?e.flatMap(t=>t.children||[]):this.children||[this]}else n=t,s=e;const{includeComments:i=!1,includeNestedRules:r=!0,flattenNested:o=!1,includeBraces:c=!0,includeSelector:l=!0,combineDeclarations:h=!0,singleLine:a=!1,indent:p=0}=s,u={includeComments:i,includeNestedRules:r,flattenNested:o,includeBraces:c,includeSelector:l,combineDeclarations:h,singleLine:a,indent:p},f=Array.isArray(n)?n:[n];if(h){const t=new Map;for(const e of f)if("css-rule"===e.type){const n=e.cssSelector;t.has(n)||t.set(n,[]),t.get(n).push(e)}else if("comment"===e.type&&"css"===e.commentType&&i){const n=`__comment_${Math.random()}`;t.set(n,[e])}let e="";for(const[n,s]of t){if(n.startsWith("__comment_")){e+=`${a?"":" ".repeat(p)}/*${s[0].content}*/`,a||(e+="\n");continue}const t={},i=[];for(const e of s)if(e.cssDeclarations&&Object.assign(t,e.cssDeclarations),r&&e.children&&0===i.length)for(const t of e.children)"css-rule"!==t.type&&"css-at-rule"!==t.type||i.push(t);e+=this.#t(n,t,i,u),a||(e+="\n")}return e.trimEnd()}let d="";for(const t of f)if("css-rule"===t.type){const e=t.cssDeclarations||{},n=[];if(r&&t.children)for(const e of t.children)"css-rule"!==e.type&&"css-at-rule"!==e.type||n.push(e);d+=this.#t(t.cssSelector,e,n,u),a||(d+="\n")}else if("comment"===t.type&&"css"===t.commentType&&i){d+=`${a?"":" ".repeat(p)}/*${t.content}*/`,a||(d+="\n")}return d.trimEnd()}#e(t,e=0){let n="";for(const s of t)if("css-rule"===s.type||"css-at-rule"===s.type)n+=this.cssToString(s,{includeNestedRules:!0,includeBraces:!0,includeSelector:!0,combineDeclarations:!1,indent:4*e}),n+="\n";else if("comment"===s.type&&"css"===s.commentType){n+=`${" ".repeat(4*e)}/*${s.content}*/\n`}else s.children&&(n+=this.#e(s.children,e));return n}#n(t){const l=[],h=t.match(i)?.filter(Boolean)?.join("")||"",a=h.match(r),p=h.match(s),u=h.match(n),f=h.match(e),d=a?a[0]:null,g=p?p[1]:null,m=u?u.map(t=>t.substring(1)):[],y=[];if(f)for(const t of f){const e=t.slice(1,-1);if(e.includes("=")){const[t,n]=e.split("="),s=n.replace(o,"$1");y.push({name:t,value:s,hasValue:!0})}else y.push({name:e,hasValue:!1})}if(t.includes(" ")){const e=t.split(c),n=this.#n(e[0]);for(const t of n){const n=e.slice(1).join(" "),s=t.#n(n);for(const t of s)l.includes(t)||l.push(t)}return l}const b=[this];for(;b.length>0;){const t=b.shift();if("tag-open"===t.type){let e=!0;if(d&&t.name!==d&&(e=!1),g&&t.getAttribute("id")!==g&&(e=!1),m.length>0){const n=(t.getAttribute("class")||"").split(c);for(const t of m)if(!n.includes(t)){e=!1;break}}if(y.length>0)for(const n of y){const s=t.getAttribute(n.name);if(n.hasValue){if(s!==n.value){e=!1;break}}else if(void 0===s){e=!1;break}}e&&l.push(t)}b.push(...t.children)}return l}#s(t){if(!t.parent)return{opening:t,closing:null,whitespace:null,removedCount:0,startIndex:-1};const e=t.parent,n=e.children.indexOf(t);if(-1===n)return{opening:t,closing:null,whitespace:null,removedCount:0,startIndex:-1};let s=null,i=null,r=1,o=n;if(n>0){const t=e.children[n-1];"text"===t.type&&""===t.content.trim()&&(i=t,o=n-1,r+=1)}return"tag-open"===t.type&&(s=this.#i(t),s&&(r+=1)),e.children.splice(o,r),t.parent=null,s&&(s.parent=null),i&&(i.parent=null),{opening:t,closing:s,whitespace:i,removedCount:r,startIndex:o}}findAllByAttr(t){const e=[],n=[this];for(;n.length>0;){const s=n.shift();"tag-open"===s.type&&Object.prototype.hasOwnProperty.call(s.attributes,t)&&e.push(s),n.push(...s.children)}return e}findAllByTag(t){const e=[],n=[this];for(;n.length>0;){const s=n.shift();"tag-open"===s.type&&s.name===t&&e.push(s),n.push(...s.children)}return e}findAllByType(t){const e=[],n=[this];for(;n.length>0;){const s=n.shift();(s.type===t||"script-block"===t&&"tag-open"===s.type&&s.scriptBlock)&&e.push(s),n.push(...s.children)}return e}#i(t){if(!t.parent||"tag-open"!==t.type)return null;const e=t.parent.children.indexOf(t);if(-1===e)return null;const n=t.parent.children[e+1];return n&&"tag-close"===n.type&&n.name===t.name?n:null}#r(e){const n=[],s=[],i=e.replace(t,(t,e)=>(s.push(e.trim()),"")).trim();let r=[];if(""===i){const t=[this];for(;t.length>0;){const e=t.shift();"tag-open"===e.type&&r.push(e),t.push(...e.children)}}else r=this.#n(i);for(const t of r){let e=!0;for(const n of s){if(this.#o().#n(n).includes(t)){e=!1;break}}e&&n.push(t)}return n}#o(){let t=this;for(;null!==t.parent;)t=t.parent;return t}#c(t){const e=[],n=t=>{for(const s of t.children)e.push(s),n(s)};return n(t),e}getAttribute(t){return this.attributes[t]}getComments(t={}){const{includeContent:e=!0,includeType:n=!0}=t,s=[],i=t=>{if("comment"===t.type)if(e||n){const i={};e&&(i.content=t.content),n&&t.commentType&&(i.commentType=t.commentType),i.node=t,s.push(i)}else s.push(t);if(t.children&&Array.isArray(t.children))for(const e of t.children)i(e)};return i(this),s}#l(t){let e="";for(const[n,s]of Object.entries(t.attributes))e+="__EMPVAL__"!==s?` ${n}="${s}"`:` ${n}`;return e}getNodesByType(t){const e=[],n=s=>{if(s.type===t&&e.push(s),s.children&&Array.isArray(s.children))for(const t of s.children)n(t)};return n(this),e}getTag(){if("text"===this.type)return this.content;if("comment"===this.type){const t=this.commentType||"html-comment";return"js-single-line"===t?`//${this.content}`:"js-multi-line"===t?`/*${this.content}*/`:`\x3c!--${this.content}--\x3e`}if("tag-open"===this.type||"tag-close"===this.type){const t=this.#l(this);return`<${this.name}${t}>`}return""}innerHtml(t=!1){let e="";for(const n of this.children)e+=n.toHtml(t);return e}insertAfter(...t){if(!this.parent)throw new Error("Cannot insert after a node with no parent");const e=t.flat();let n=this;if("tag-open"===this.type&&!this.#h(this)){const t=this.#i(this);t&&(n=t)}let s=n.parent.children.indexOf(n);if(-1===s)throw new Error("Node not found in parent's children");s+=1;for(const t of e){let e=null,i=null;if(t.parent){const r=t.parent===n.parent,o=this.#s(t);e=o.closing,i=o.whitespace,r&&-1!==o.startIndex&&o.startIndex<s&&(s-=o.removedCount)}i&&(i.parent=n.parent,n.parent.children.splice(s,0,i),s+=1),t.parent=n.parent,n.parent.children.splice(s,0,t),s+=1,e&&(e.parent=n.parent,n.parent.children.splice(s,0,e),s+=1)}return this}insertBefore(...t){if(!this.parent)throw new Error("Cannot insert before a node with no parent");const e=t.flat();let n=this;if("tag-close"===this.type){const t=this.parent.children.indexOf(this);if(-1===t)throw new Error("Node not found in parent's children");const e=this.parent.children[t-1];e&&"tag-open"===e.type&&e.name===this.name&&(n=e)}let s=n.parent.children.indexOf(n);if(-1===s)throw new Error("Node not found in parent's children");for(const t of e){let e=null,i=null;if(t.parent){const r=t.parent===n.parent,o=this.#s(t);e=o.closing,i=o.whitespace,r&&-1!==o.startIndex&&o.startIndex<s&&(s-=o.removedCount)}i&&(i.parent=n.parent,n.parent.children.splice(s,0,i),s+=1),t.parent=n.parent,n.parent.children.splice(s,0,t),s+=1,e&&(e.parent=n.parent,n.parent.children.splice(s,0,e),s+=1)}return this}insertAdjacentHTML(t,e){const n=["beforebegin","afterbegin","beforeend","afterend"];if(!n.includes(t))throw new Error(`Invalid position: ${t}. Must be one of: ${n.join(", ")}`);const s=this.#o().parser;if(!s||"function"!=typeof s.parse)throw new Error("Parser not found. Node tree must be created via parser.parse()");const i=s.parse(e).children.flat();if(0===i.length)return this;let r=this;if("tag-close"===this.type){const t=this.parent.children.indexOf(this);if(-1!==t){const e=this.parent.children[t-1];"tag-open"===e?.type&&e.name===this.name&&(r=e)}}switch(t){case"beforebegin":if(!r.parent)throw new Error("Cannot insert beforebegin on node with no parent");r.insertBefore(...i);break;case"afterbegin":if("tag-open"!==r.type)throw new Error("afterbegin can only be used on element nodes");if(l.includes(r.name))throw new Error("afterbegin cannot be used on void elements");for(let t=i.length-1;t>=0;t--)i[t].parent=r,r.children.unshift(i[t]);break;case"beforeend":if("tag-open"!==r.type)throw new Error("beforeend can only be used on element nodes");if(l.includes(r.name))throw new Error("beforeend cannot be used on void elements");r.appendChild(...i);break;case"afterend":if(!r.parent)throw new Error("Cannot insert afterend on node with no parent");r.insertAfter(...i)}return this}#h(t){return"tag-open"===t.type&&l.includes(t.name)}outerHtml(t=!1){return this.toHtml(t)}querySelector(t){const e=this.querySelectorAll(t);return e.length>0?e[0]:null}querySelectorAll(t){if(t.includes(",")){const e=t.split(",").map(t=>t.trim()),n=[];for(const t of e){const e=this.#r(t);for(const t of e)n.includes(t)||n.push(t)}return n}return this.#r(t)}remove(){if(this.parent){const t=this.parent.children.indexOf(this);if(-1!==t){if("tag-open"===this.type&&t+1<this.parent.children.length){const e=this.parent.children[t+1];if("tag-close"===e.type&&e.name===this.name)return this.parent.children.splice(t,2),this.parent=null,this}if("tag-close"===this.type&&t>0){const e=this.parent.children[t-1];if("tag-open"===e.type&&e.name===this.name)return this.parent.children.splice(t-1,2),this.parent=null,this}this.parent.children.splice(t,1),this.parent=null}}return this}removeAttribute(t){delete this.attributes[t]}replaceWith(...t){if(!this.parent)throw new Error("Cannot replace a node with no parent");const e=t.flat(),n=this.parent.children.indexOf(this);if(-1===n)throw new Error("Node not found in parent's children");const{parent:s}=this,i=[this];let r=1;if("tag-open"===this.type){const t=this.#i(this);t&&(i.push(t),r=2);const e=this.#c(this);i.push(...e)}const o=[];for(const t of e)if(t.parent){const e=this.#s(t);o.push(e)}else o.push({opening:t,closing:null,whitespace:null,removedCount:0});s.children.splice(n,r);let c=n;for(const t of o)t.whitespace&&(t.whitespace.parent=s,s.children.splice(c,0,t.whitespace),c+=1),t.opening.parent=s,s.children.splice(c,0,t.opening),c+=1,t.closing&&(t.closing.parent=s,s.children.splice(c,0,t.closing),c+=1);for(const t of i)t.parent=null;return this}setAttribute(t,e){this.attributes[t]=e}toHtml(t=!1){if("text"===this.type)return this.content;if("comment"===this.type){if(!t)return"";const e=this.commentType||"html-comment";return"js-single-line"===e?`//${this.content}`:"js-multi-line"===e?`/*${this.content}*/`:`\x3c!--${this.content}--\x3e`}if("tag-open"===this.type){const e=this.#l(this);let n=`<${this.name}${e}>`;if(this.styleBlock&&this.children.length>0)n+=`\n${this.#e(this.children,0)}`;else for(const e of this.children)n+=e.toHtml(t);return n}if("tag-close"===this.type)return`</${this.name}>`;let e="";for(const n of this.children)e+=n.toHtml(t);return e}toString(){return this.toHtml(!0)}updateAttribute(t,e,n=" "){if(!(t in this.attributes))return void(this.attributes[t]=e);const s=this.attributes[t];s.split(n).includes(e)||(this.attributes[t]=`${s}${n}${e}`)}visualize(t={}){const e={contentPreviewLength:20,returnString:!1,showAttributes:!0,showContent:!0,showNodeNumber:!1,showNodeType:!1,...t},{contentPreviewLength:n,returnString:s,showAttributes:i,showContent:r,showNodeNumber:o,showNodeType:c}=e;let l="",h=0;const a=t=>{if(!t||!r)return"";const e=t.trim();return e.length?e.length>n?`: "${e.substring(0,n-3)}..."`:`: "${e}"`:""},p=t=>i&&0!==Object.keys(t).length?` ${Object.entries(t).map(([t,e])=>"__EMPVAL__"===e?t:`${t}="${e}"`).join(" ")}`:"";let u="";if("root"===this.type)u="ROOT";else if("text"===this.type)u=`TEXT${a(this.content)}`;else if("comment"===this.type){u=`COMMENT${this.commentType?` (${this.commentType})`:""}${a(this.content)}`}else if("tag-open"===this.type){const t=p(this.attributes);u=`<${this.name}${t}>`}else"tag-close"===this.type&&(u=`</${this.name}>`);c&&(u+=` (${this.type}`,this.scriptBlock&&(u+=", script-block"),u+=")"),o&&(u+=` [${h}]`,h+=1),l+=`${u}\n`;const{children:f}=this;for(let t=0;t<f.length;t++){const e=t===f.length-1,n=e?"└── ":"├── ";d(f[t],n,e,[])}function d(t,e,n,s){let i="";if("text"===t.type)i=`TEXT${a(t.content)}`;else if("comment"===t.type){i=`COMMENT${t.commentType?` (${t.commentType})`:""}${a(t.content)}`}else if("tag-open"===t.type){const e=p(t.attributes);i=`<${t.name}${e}>`}else"tag-close"===t.type&&(i=`</${t.name}>`);if(l+=`${s.join("")}${e}${i}`,c&&(l+=` (${t.type}`,t.scriptBlock&&(l+=", script-block"),l+=")"),o&&(l+=` [${h}]`,h+=1),l+="\n",t.children.length>0){const e=n?"    ":"│   ",i=[...s,e];for(let e=0;e<t.children.length;e++){const n=e===t.children.length-1,s=n?"└── ":"├── ";d(t.children[e],s,n,i)}}}if(s)return l;console.log(l)}}const a={atRuleName:/[a-zA-Z\-]/,whitespace:/\s/};class p{#a="";#p=0;#u=0;constructor(){}parse(t){this.#a=t,this.#u=0,this.#p=t.length;const e=new h("css-root");for(;this.#u<this.#p&&(this.#f(),!(this.#u>=this.#p));){if("/"===this.#d()&&"*"===this.#d(1)){const t=this.#g();t&&e.appendChild(t);continue}if("@"===this.#d()){const t=this.#m(e);t&&e.appendChild(t);continue}const t=this.#y(e);t&&e.appendChild(t)}return e}version(){return"CSS Parser v1.0.0"}#b(){let t=this.#u,e=0,n=!1,s=!1;for(;t<this.#p;){const i=this.#a[t];if("("===i)e+=1;else if(")"===i)e-=1;else if(0===e){if(":"===i&&":"!==this.#a[t+1]){n=!0;break}if("{"===i){s=!0;break}if(";"===i||"}"===i)break}t+=1}return s&&!n}#m(t){if("@"!==this.#d())return null;this.#u+=1;const e=this.#u;for(;this.#u<this.#p&&a.atRuleName.test(this.#a[this.#u]);)this.#u+=1;const n=this.#a.substring(e,this.#u);this.#f();const s=new h("css-at-rule",n,{},t);if(s.cssName=n,"import"===n||"charset"===n||"namespace"===n){const t=this.#u;for(;this.#u<this.#p&&";"!==this.#d();)this.#u+=1;return s.cssParams=this.#a.substring(t,this.#u).trim(),";"===this.#d()&&(this.#u+=1),s}const i=this.#u;let r=0,o=!0;for(;this.#u<this.#p&&o;){const t=this.#d();if("("===t)r+=1;else if(")"===t)r-=1;else if("{"===t&&0===r){o=!1;break}this.#u+=1}return s.cssParams=this.#a.substring(i,this.#u).trim(),this.#f(),"{"===this.#d()&&(this.#u+=1,this.#w(s)),s}#w(t){for(;this.#u<this.#p&&(this.#f(),!(this.#u>=this.#p));){const e=this.#d();if("}"===e){this.#u+=1;break}if("/"===e&&"*"===this.#d(1)){const e=this.#g();e&&t.appendChild(e);continue}if("@"===e){const e=this.#m(t);e&&t.appendChild(e);continue}if(this.#b()){const e=this.#y(t);e&&t.appendChild(e)}else this.#$(t)}}#g(){if("/"!==this.#d()||"*"!==this.#d(1))return null;this.#u+=2;const t=this.#u;let e=this.#a.indexOf("*/",this.#u);-1===e?(e=this.#p,this.#u=this.#p):this.#u=e+2;const n=new h("comment");return n.content=this.#a.substring(t,e),n.commentType="css",n}#$(t){const e=this.#u;for(;this.#u<this.#p&&":"!==this.#d()&&"}"!==this.#d();)this.#u+=1;const n=this.#a.substring(e,this.#u).trim();if(":"!==this.#d()){for(;this.#u<this.#p&&";"!==this.#d()&&"}"!==this.#d();)this.#u+=1;return void(";"===this.#d()&&(this.#u+=1))}this.#u+=1,this.#f();const s=this.#u;let i=0;for(;this.#u<this.#p;){const t=this.#d();if("("===t)i+=1;else if(")"===t)i-=1;else if(0===i&&(";"===t||"}"===t))break;this.#u+=1}const r=this.#a.substring(s,this.#u).trim();t.cssDeclarations||(t.cssDeclarations={}),n&&r&&(t.cssDeclarations[n]=r),";"===this.#d()&&(this.#u+=1)}#y(t){const e=this.#u;let n=0;for(;this.#u<this.#p;){const t=this.#d();if("("===t)n+=1;else if(")"===t)n-=1;else if("{"===t&&0===n)break;this.#u+=1}const s=this.#a.substring(e,this.#u).trim();if(!s||"{"!==this.#d())return null;const i=new h("css-rule",s,{},t);return i.cssSelector=s,i.cssDeclarations={},this.#u+=1,this.#w(i),i}#d(t=0){const e=this.#u+t;return e<this.#p?this.#a[e]:""}#f(){for(;this.#u<this.#p&&a.whitespace.test(this.#a[this.#u]);)this.#u+=1}}const u={attributePattern:/([\w-]+)(?:=(?:"([^"]*)"|'([^']*)'|(\S+)))?/g,jsRegexContext:/[\(\[{,;=:&|!?]/,validTagName:/[a-zA-Z0-9_\-]/,whitespace:/\s+/},f=["img","br","hr","input","meta","link","area","base","col","embed","param","source","track","wbr"];class d{#k=[];constructor(t=["jhp","s_"]){this.#k=t}getSpecialTags(){return[...this.#k]}parse(t){const e=new h("root");e.parser=this;let n=e,s=0;for(;s<t.length;){if("<"===t[s]&&"\x3c!--"===t.substring(s,s+4)){const e=t.indexOf("--\x3e",s);if(-1===e){s+=1;continue}const i=t.substring(s+4,e),r=new h("comment","",{},n);r.content=i,r.commentType="html-comment",n.appendChild(r),s=e+3;continue}if("<"===t[s]&&("<"===t[s+1]||" "===t[s+1]||"/"!==t[s+1]&&"!"!==t[s+1]&&!u.validTagName.test(t[s+1]))){const e=t.indexOf("<",s+1),i=-1===e?t.length:e,r=new h("text");r.content=t.substring(s,i),n.appendChild(r),s=i;continue}if("<"===t[s]&&"/"!==t[s+1]){const e=t.indexOf(">",s);if(-1===e){s+=1;continue}const i=t.substring(s+1,e),r=i.split(u.whitespace)[0],o={},c=u.attributePattern;let l;const a=i.substring(r.length);let d=0;for(;null!==(l=c.exec(a));){d+=1;const t=l[1],e=l[2]||l[3]||l[4]||"__EMPVAL__";o[t]=e}const g=new h("tag-open",r,o,n);if(n.appendChild(g),"style"===r){const i=`</${r}>`,o=t.indexOf(i,s);if(-1!==o){g.styleBlock=!0;const c=t.substring(e+1,o),l=(new p).parse(c);g.children=l.children,s=o+i.length;const a=new h("tag-close",r,{},n);a.styleBlock=!0,n.appendChild(a);continue}}if(this.#k.includes(r)&&0===d){g.scriptBlock=!0;const i=`</${r}>`,o=t.indexOf(i,e);if(-1!==o){const c=t.substring(e+1,o);let l=!1,a="",p=!1,f=!1,d="",m=-1,y=0;for(let t=0;t<c.length;t++){const e=c[t],n=t<c.length-1?c[t+1]:"",s=t>0?c[t-1]:"";if("\\"!==s)if(f||p||'"'!==e&&"'"!==e&&"`"!==e)if(f||l||"/"!==e||"*"===s||0!==t&&!u.jsRegexContext.test(c[t-1]))if(p&&"/"===e&&"\\"!==s)p=!1;else if(l||p||f){if(f)if("js-single-line"===d&&"\n"===e){const e=new h("comment","",{},g);e.content=c.substring(m,t),e.commentType=d,g.appendChild(e),f=!1,y=t+1}else if("js-multi-line"===d&&"*"===e&&"/"===n){const e=new h("comment","",{},g);e.content=c.substring(m,t),e.commentType=d,g.appendChild(e),f=!1,y=t+2,t+=1}}else{if("/"===e&&"/"===n){if(y<t){const e=new h("text");e.content=c.substring(y,t),g.appendChild(e)}f=!0,d="js-single-line",m=t+2,t+=1;continue}if("/"===e&&"*"===n){if(y<t){const e=new h("text");e.content=c.substring(y,t),g.appendChild(e)}f=!0,d="js-multi-line",m=t+2,t+=1;continue}}else p=!0;else l?e===a&&(l=!1):(l=!0,a=e)}if(f){const t=new h("comment","",{},g);t.content=c.substring(m),t.commentType=d,g.appendChild(t)}else if(y<c.length){const t=new h("text");t.content=c.substring(y),g.appendChild(t)}const b=new h("tag-close",r,{},n);b.scriptBlock=!0,n.appendChild(b),s=o+i.length;continue}}f.includes(r)||(n=g),s=e+1;continue}if("<"===t[s]&&"/"===t[s+1]){const e=t.indexOf(">",s);if(-1===e){s+=1;continue}const i=t.substring(s+2,e),r=new h("tag-close",i);let o=n,c=!1;for(;o&&"root"!==o.type;){if("tag-open"===o.type&&o.name===i){o.parent.appendChild(r),n=o.parent,c=!0;break}o=o.parent}c||n.appendChild(r),s=e+1;continue}const e=t.indexOf("<",s),i=-1===e?t.length:e;if(i>s){const e=t.substring(s,i),r=new h("text");r.content=e,n.appendChild(r)}s=i}return e}version(){return"Simple Html Parser v1.4.0"}}export{p as CSSParser,h as Node,d as SimpleHtmlParser,d as default};
